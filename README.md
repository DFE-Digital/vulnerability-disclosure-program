# Vulnerability Disclosure Program

The [vulnerability disclosure program is a project that DfE has been onboarding to with the help of NCSC](https://www.ncsc.gov.uk/information/vulnerability-disclosure-toolkit). It involves [a toolkit designed to help us make it easier for security researchers to contact the correct teams](https://www.ncsc.gov.uk/files/NCSC-Vulnerability-disclosure-Toolkit-v2.pdf) in order to report vulnerabilities they've discovered.

In order to more easily report vulnerabilities, the toolkit suggests:
* forms of communication - in our case there is a [Hackerone vulnerability disclosure link](https://hackerone.com/41ff5198-0e21-4656-9f54-03cce570d7ff/embedded_submissions/new) that goes directly to the vulnerability management team
* a clear policy on what we expect from someone reporting a vulnerability and how we will respond
* a security.txt file that can be published for all web services at the standard location (`/.well-known`) - DfE CISD have deployed a security.txt file that contains all of the necessary details linking to our communication options and also a thanks.txt file that gives acknowledgements to researchers

The idea is based on the [GDS/Cabinet Office centrally hosted PaaS project for VDP](https://github.com/alphagov/security.txt). The difference being, this project will be hosted on an Azure Storage static site, due to PaaS now being decommissioned. 

## How to sign up for DfE's VDP

### Security.txt Redirection
In order to take advantage of the disclosure and triaging of vulnerabilities, digital services can set the origin or submit a `302` redirect to the centrally hosted security.txt when they attempt to browse to the "standard location" for a security.txt file.

For example:

If a user on your site attempts to browse to `https://your-app/.well-known/security.txt` or `https://your-app/security.txt` then set the origin or do a `302` redirect to `https://vdp.security.education.gov.uk/.well-known/security.txt`.

Likewise, if they attempt to browse to  `https://your-app/thanks.txt` then set the origin or do a `302` redirect to `https://vdp.security.education.gov.uk/thanks.txt`.

#### Example Terraform Configuration
If you are using Terraform you could create a CDN rule similar to the following:

```
resource "azurerm_cdn_frontdoor_rule" "security_txt_rule" {
  depends_on = [<DOMAINS/ORIGINS>]
  name                      = "security_txt_redirect"
  cdn_frontdoor_rule_set_id = azurerm_cdn_frontdoor_rule_set.<ruleset_name>.id
  order                     = 1
  behavior_on_match         = "Continue"

  actions {

    url_redirect_action {
      redirect_type        = "Found"
      redirect_protocol    = "Https"
      destination_hostname = "vdp.security.education.gov.uk"
      destination_path     = "/.well-known/security.txt"
    }
  }

  conditions {
    url_filename_condition {
      operator         = "Equal"
      match_values     = ["security.txt"]
      transforms       = ["Lowercase", "RemoveNulls", "Trim"]
    }
  }
```
### Ensure the VM team have your up to date contacts
To make sure that the vulnerability management team can contact the right people in your team within a reasonable time period after a disclosure has been sent to them, we ask that you provide a group email address to them so you can be contacted regardless of leavers/joiners processes. ==ENTER SHARED EMAIL FOR VM==

## Contributing to the security.txt or thanks.txt
The security.txt and thanks.txt files are deployed via Terraform to Azure Storage Blobs as a static site. 

Please don't hesitate to raise a Pull Request against the repository should you wish to suggest improvements to the files or deployment. A member of CISD will review and approve PRs, which will trigger a GitHub Actions pipeline to redeploy the changes.

If you have a security researcher who has requested a bounty, please ensure you state that we do not provide monetary bounties, but will be happy to list their name under our acknowledgements page (thanks.txt). This can be done whether the notification was via the VDP or not and you can either request the change from the VM team, or raise a PR directly.

## Design Decisions

The site will be:

* deployed by terraform
* use github actions for ci
* changes can be made via pull request
* files to be hosted in Azure Storage

## Contributing

Please see our [contributing guidelines if you'd like to raise a bug or pull request](.github/CONTRIBUTING.md).
